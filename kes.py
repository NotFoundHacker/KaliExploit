import sys
import string
import importlib
from colorama import Fore, Style
import os

def help():
	print(Fore.YELLOW+"""
help show this command
use -to use exploit, auxiliary or payload ex: use type:exploit exploit.FastFuzzer
run -to run an exploit, auxiliary or payload
clear -clear screen
show -shows exploit, auxiliary or payload ex: show exploit
		"""+Style.RESET_ALL)
def exploit_help():
	print("""
run     - run exploit
help    - shows this 
set     - set RHOST or RPORT
options - options in them exploit""")

def banner():
	BannerFile="banner.txt"
	FileBanner=open(BannerFile, 'r')
	Banner=FileBanner.read()
	print("")
	print(Fore.RED+Banner+Style.RESET_ALL)
	print("\n\n")
	print(Fore.RED+"[+] Threat level - 999"+Style.RESET_ALL)
	print(Fore.GREEN+"[+] Password authentication - Hacker"+Style.RESET_ALL)
	print(Fore.GREEN+"[+] Acess Granted"+Style.RESET_ALL)
banner()
while True:
	command=input("[KES] > ")

	if command=="help":
		help()

	elif command=="exit":
		exit()

	if command=="banner":
		banner()
	if command.startswith("use exploit "):
			module_name = command.split(" ")[2]
			print("Loading module: %s" % (module_name))
			try:
				module = importlib.import_module(module_name)
			except Exception as e:
				print(e)
				continue
			CONTEXT = module_name
			exploit = module.Exploit()
			exploit.show_info()
			try:
				exploit.show_options()
			except:
				pass
			print("%s" % ("-" * 0x40))
			print(Fore.CYAN+"[ + ]"+Style.RESET_ALL+"Exploit is ready")
			while True:
				module_command = input(Fore.RED+"[KES] exploit({})=> ".format(CONTEXT)+Style.RESET_ALL)
				if command=="banner":
					banner()
				if module_command == "clear":
					os.system("clear")
					continue
				if module_command == "help":
					exploit_help()
					continue
				if module_command.startswith("set "):
					if len(module_command.split(" ")) == 3:
						key = module_command.split(" ")[1]
						value = module_command.split(" ")[2]
						exploit.set_config(key, value)
					else:
						print("Check your input!")
						print("Example: \n\tset [KEY] [VALUE]")
				elif module_command == "options":
					exploit.show_options()
				elif module_command == "info":
					exploit.show_info()
				elif module_command == "run":
					exploit.run()
				elif module_command == "quit" or module_command == "q" or module_command == "exit" or module_command == "back":
					break
				if module_command=="ls":
					os.system("ls")
	elif command=="clear":
		os.system("clear")