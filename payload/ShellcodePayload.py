import sys
import random
from colorama import *

class Payload:

	config={
		"chars": 418,
		"file" : "kes.txt"
	}
	def show_options(self):
		print(Fore.YELLOW+"Options"+Style.RESET_ALL)
		print(Fore.YELLOW+"-------"+Style.RESET_ALL)
		for key in sorted(self.config.keys()):
			print(Fore.YELLOW+key, self.config[key], self.get_config(key)+Style.RESET_ALL)
			

	@staticmethod
	def show_info():
		print(Fore.YELLOW+"\nThis Payload generates a shellcode."+Style.RESET_ALL)

	
	def set_config(self, key, value):
		if key in self.config.keys():
			self.config[key]= value
		else:
			print("No options")
	
	
	def get_config(self, key):
		return self.config[key]

	def run(self):
		char="\xeb\x19\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x59\x31\xd2\xb2\x16\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xb3\x01\xcd\x80\xe8\xe2\xff\xff\xff\x45\x76\x31\x6c\x20\x68\x34\x63\x6b\x20\x54\x33\x6a\x76\x31\x6c\x20\x31\x33\x33\x37\x3f\x20"
		buf=""
		for i in range(self.config["chars"]):
			bytesGen=random.choice(char)
			buf+=bytesGen
		print(bytes(buf, encoding='utf-8'))
		print("shellcode size: ",sys.getsizeof(buf))
		Save=open(self.config["file"], "+a")
		Save.write(bytes(buf, encoding='utf-8'))
		Save.close()
